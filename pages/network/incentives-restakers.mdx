# Restaking Incentives for Restakers

## Overview

Tangle Network incentivizes restakers through TNT rewards for depositing specific assets as well as with service revenue and fee rewards. Deposit rewards are distributed in an ongoing manner and are immediately claimable. Service revenue is distributed in fixed time intervals according to governance.

The protocol determines which assets are incentivized for deposits and their maximum deposit capacities through governance decisions. Non-incentivized assets are still valid for deposits and can be leveraged to instance Tangle Blueprints.

### Score vs Points

For the purposes of avoiding confusion we use the terms points and score independently. Points refer to any future airdrop and scores refer to onchain values that we leverage for distributing onchain rewards, whether from deposits or services. Points are NOT equal to score values! Hopefully we don't mistake them in the docs.

## Deposit Mechanics

Depositing incentivized assets on Tangle earns your TNT tokens and points in upcoming airdrops. There are a list of assets onchain that are incentivized. For these assets, there exists a **vault** for them specifying the capacity and APY for deposits.

### Deposit Capacity

The restaking system implements maximum deposit capacities for each incentivized asset to ensure secure and controlled TVL growth. Key aspects:

- Fixed maximum amount per asset
- APY distributed proportionally to deposits/capacity ratio
- Unallocated APY is never minted
- APY defines reward allocation at full capacity

### Protocol Implementation

The `pallet-multi-asset-delegation` system manages:

- Deposit and withdrawal logic
- Delegation to operators
- Asset staking mechanisms
- APY and capacity configurations
- System upgrades via governance

Users can view available assets and their parameters through the Tangle Restaking dApp.

### Withdrawal Process

- Standard withdrawal delay: ~7 days (W sessions)
- Deposits continue earning incentives during withdrawal period
- Assets must be unstaked before withdrawal

## Scoring and Rewards

When Tangle Blueprints are instanced, a new service is created. Customers instance Tangle Blueprints by selecting the operators and types of restaked assets they desire for security. They pay for the service in advance and throughout operation for task based services.

The payments and fees are distributed according to a scoring mechanism that is normalized against the USD value of the service instance's assets.

TNT is the default restaking asset and must be included as restaked security collateral for all service instances. We treat TNT as a special asset when scoring. TNT earns a score of 1 value per 1 TNT allocated to secure the service, whereas other assets earn a score of 1 value per $1 allocated to secure the service.

### Lock Multipliers

Users can enhance their score through time-locks. This locks their deposited assets for additional months, preventing any withdrawals or unstaking until the lock has ended:

- Longer locks = higher score multiplier
- Locked tokens cannot be withdrawn until expiry
- Multiplier directly impacts reward share

### Reward Calculation for Deposits

The total reward formula $R$ for a user at any point is the sum of the base reward and lock reward:

$R = R_{base} + R_{lock}$

Where the base reward is:

$R_{base} = APY \times \frac{D_u}{D_t} \times \frac{D_t}{C}$

And the lock reward is:

$R_{lock} = D_u \times APY \times M \times \frac{T_r}{T_t}$

Where:

- $APY$ = Asset's annual percentage yield
- $D_u$ = User's deposit amount
- $D_t$ = Total deposits for the asset
- $C$ = Maximum deposit capacity
- $M$ = Lock multiplier
- $T_r$ = Remaining lock time
- $T_t$ = Total lock time

### Score Distribution

The protocol uses an updated scoring mechanism to allocate service revenue and fee rewards:

- Base TNT score: 1 point per 1 TNT restaked.
- Base non-TNT score: 1 point per $1 of token restaked * $LOCK\_MULTIPLIER$.
- Pro-rata distribution based on user scores
- On-chain calculation at each reward interval

### Reward Calculation for Service Rewards

The reward formula $R$ for a restaker securing a service instance is calculated as:

$R = Rewards \times \frac{S_u}{S_t}$

Where:

- $Rewards$ = Rewards and fees of the service instance
- $S_u$ = User's restaking score for the service instance
- $S_t$ = Total score across all active assets of the service instance

## Example Scenario: Calculating Restaking Rewards

Let's walk through a practical example to understand how restaking rewards are calculated.

### Initial Parameters

- Asset: WETH (Wrapped ETH)
- TNT inflation allocation: 1%
- Maximum deposit capacity: 1,000 WETH
- Base scoring rate: 1 point per WETH

### Alice's Position

When Alice locks 10 WETH for a 12-month period:

1. Her score is calculated as:

   - Base score: 10 (from 10 WETH)
   - Lock multiplier: 12x (12 months)
   - Total score: 10 × 12 = 120 score

2. Her reward share is determined by:
   ```
   Annual Reward = 1% × (Alice's Score / Total WETH Score) × (Total WETH Deposits / Max Capacity)
   ```

For example, if:

- Total WETH score across all restakers = 1,000 score
- Current total WETH deposits = 500 WETH

Then Alice's annual reward would be:
