import GithubFileReaderDisplay from '/components/GithubFileReaderDisplay';

# Blueprint Jobs Macro System Documentation

The goal with the job macro is to provide an easy and intuitive interface for creating a task based AVS service.

Developers can specify jobs for their AVS to complete and streamline on-chain transaction submissions to protocols like
Tangle or Eigenlayer. The system is flexible and allows developers to listen to events from a variety of sources such
as Tangle's job submission/execution system, an EVM smart contract's events, periodic timers for cron-job like tasks,
as well as custom event listeners.

These job functions are triggered every time the respective event listener fires, and can be synchronous or asynchronous.

The jobs system is continuously being improved and the API may continue to change.
We welcome you to share feature requests and PRs on [our github](https://github.com/tangle-network/gadget/issues).

## The #[job] Macro

The `#[job]` macro is used to define individual tasks or jobs within a blueprint. It allows you to specify various parameters and metadata for each job.

<GithubFileReaderDisplay 
  url="https://github.com/tangle-network/blueprint-template/blob/main/src/lib.rs"
  fromLine={16}
  toLine={32}
  title="Example Job Macro Usage"
/>

- **_`id`_**: A unique identifier for the job.
- **_`params`_**: A list of parameters that the job accepts.
- **_`result`_**: The type of result the job produces (often represented by an underscore \_).
- **_`event_listener`_**: Specifies the event listener that triggers the job.

### Non-Tangle Blueprint Jobs

For other restaking protocols and job verification mechanisms, developers should use or implement custom handlers.

An example of doing this to replicate Tangle's default implementation is as follows:

```rust
struct CustomTangleJobCallListener {
    instance: <contract_instance>,
}

impl EventListener for CustomJobCallListener {
    fn next_event();
    fn handle_event();
}

#[job(
    id = <job_id>,
    params(<param_list>),
    result(<result_type>),
    event_listener(
        listener = CustomTangleJobCallListener,
    )
)]
pub fn job_name(<parameters>) -> Result<<return_type>, <error_type>> {
    // Job implementation
}
```

## Examples

### Incredible Squaring Simple

<GithubFileReaderDisplay 
  url="https://github.com/tangle-network/gadget/blob/main/blueprints/incredible-squaring/src/lib.rs"
  fromLine={9}
  toLine={21}
  title="Example Simple Squaring Job"
/>

### Incredible Squaring Eigenlayer

### MPC Keygen

<GithubFileReaderDisplay 
  url="https://github.com/tangle-network/frost-blueprint/blob/main/src/keygen.rs"
  fromLine={49}
  toLine={122}
  title="Example FROST Keygen Job"
/>

### MPC Threshold Signature

<GithubFileReaderDisplay 
  url="https://github.com/tangle-network/frost-blueprint/blob/main/src/sign.rs"
  fromLine={54}
  toLine={123}
  title="Example FROST Signing Job"
/>
